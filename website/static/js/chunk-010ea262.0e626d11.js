(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-010ea262"],{1938:function(e,t,a){},6124:function(e,t,a){"use strict";a("1938")},e340:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"navbar"},[r("img",{staticClass:"one_logo",attrs:{src:a("4135"),alt:"",srcset:""}}),r("div",{staticClass:"navbar-right"},[r("img",{staticClass:"user-avatar",attrs:{src:e.userInfo.photo}}),r("svg-icon",{staticClass:"tuichu",attrs:{"icon-class":"tuichu"},nativeOn:{click:function(t){return e.logout(t)}}})],1)]),r("div",{staticClass:"table"},[r("el-button",{attrs:{type:"text"},on:{click:e.refresh}},[e._v("刷新")]),r("el-button",{attrs:{type:"text"},on:{click:e.addUser}},[e._v("新增")]),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"accountData",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-style":e.tableHeader,stripe:""},on:{"row-dblclick":e.userEdit,"selection-change":e.userSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),r("el-table-column",{attrs:{prop:"id",align:"center",label:"ID",width:"170"}}),r("el-table-column",{attrs:{prop:"email",align:"center",label:"邮箱",width:"200"}}),r("el-table-column",{attrs:{prop:"userName",align:"center",label:"用户名"}}),r("el-table-column",{attrs:{prop:"status",align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?r("span",[e._v("启用")]):e._e(),3==t.row.status?r("span",[e._v("禁用")]):e._e()]}}])}),r("el-table-column",{attrs:{prop:"registerDate",align:"center",label:"注册日期",width:"180"}}),r("el-table-column",{attrs:{prop:"contactNo",align:"center",label:"联系方式"}}),r("el-table-column",{attrs:{prop:"company",align:"center",label:"企业"}}),r("el-table-column",{attrs:{prop:"profession",align:"center",label:"职业"}}),r("el-table-column",{attrs:{prop:"industry",align:"center",label:"行业"}}),r("el-table-column",{attrs:{prop:"activeState",align:"center",label:"激活状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.activeState?r("span",[e._v("试用中")]):e._e(),2==t.row.activeState?r("span",[e._v(" 激活成功")]):e._e(),3==t.row.activeState?r("span",[e._v("试用过期")]):e._e(),4==t.row.activeState?r("span",[e._v("激活失败")]):e._e()]}}])}),r("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticClass:"table-btn",on:{click:function(a){return a.stopPropagation(),e.userDel(t.row)}}},[e._v("删除")]),r("el-divider",{attrs:{direction:"vertical"}}),r("span",{staticClass:"table-btn",on:{click:function(a){return a.stopPropagation(),e.userEdit(t.row)}}},[e._v("编辑")])]}}])})],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.fieldsTotal>=e.fieldsQuery.pageSize,expression:"fieldsTotal>=fieldsQuery.pageSize"}],attrs:{total:e.fieldsTotal,page:e.fieldsQuery.pageNum,limit:e.fieldsQuery.pageSize},on:{"update:page":function(t){return e.$set(e.fieldsQuery,"pageNum",t)},"update:limit":function(t){return e.$set(e.fieldsQuery,"pageSize",t)},pagination:e.getQueryPlatformUser}})],1),r("user-form",{ref:"userForm",on:{ok:e.refresh}})],1)},o=[],l=a("1da1"),s=(a("d3b7"),a("96cf"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.title,"close-on-click-modal":!1,visible:e.dialogVisible,width:"800px","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.rules,size:"small"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[a("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1)],1),e.form.id?e._e():a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择用户状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"启用",value:1}}),a("el-option",{attrs:{label:"禁用",value:3}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"联系方式",prop:"contactNo"}},[a("el-input",{attrs:{placeholder:"请输入联系方式"},model:{value:e.form.contactNo,callback:function(t){e.$set(e.form,"contactNo",t)},expression:"form.contactNo"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"企业",prop:"company"}},[a("el-input",{attrs:{placeholder:"请输入用户所在企业"},model:{value:e.form.company,callback:function(t){e.$set(e.form,"company",t)},expression:"form.company"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"职业",prop:"profession"}},[a("el-input",{attrs:{placeholder:"请输入用户职业"},model:{value:e.form.profession,callback:function(t){e.$set(e.form,"profession",t)},expression:"form.profession"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"行业",prop:"industry"}},[a("el-input",{attrs:{placeholder:"请输入用户行业"},model:{value:e.form.industry,callback:function(t){e.$set(e.form,"industry",t)},expression:"form.industry"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"激活状态",prop:"activeState"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择激活状态"},model:{value:e.form.activeState,callback:function(t){e.$set(e.form,"activeState",t)},expression:"form.activeState"}},[a("el-option",{attrs:{label:"试用中",value:1}}),a("el-option",{attrs:{label:"激活成功",value:2}}),a("el-option",{attrs:{label:"试用过期",value:3}}),a("el-option",{attrs:{label:"激活失败",value:4}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"国家",prop:"locale"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择用户注册国家"},model:{value:e.form.locale,callback:function(t){e.$set(e.form,"locale",t)},expression:"form.locale"}},[a("el-option",{attrs:{label:"中国",value:"中国"}})],1)],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{loading:e.btnLoading},on:{click:e.handleClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:e.submitForm}},[e._v("确 定")])],1)],1)}),n=[],i=a("5530"),c=(a("ac1f"),a("00b4"),a("b775"));function u(e){return Object(c["a"])({url:"/platformUser/queryPlatformUser",method:"post",data:e})}function f(e){return Object(c["a"])({url:"/platformUser/createPlatformUser",method:"post",data:e})}function m(e){return Object(c["a"])({url:"/platformUser/updatePlatformUser",method:"post",data:e})}function d(e){return Object(c["a"])({url:"/platformUser/deletePlatformUser/"+e,method:"delete"})}var p=a("cf45"),b={name:"UserForm",data:function(){var e=function(e,t,a){""===t?a(new Error("请输入密码")):(console.log(t),/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,20}$/.test(t)?a():a(new Error("密码必须包含数字、小写、大写字母，最小8位，最大20位字符组成")))};return{dialogVisible:!1,title:"",btnLoading:!1,formerForm:{},form:{email:"",userName:"",password:"",status:1,contactNo:"",company:"",profession:"",industry:"",activeState:"",locale:"中国",timeZone:'"UTC/GMT: +8:00"'},rules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],userName:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{validator:e,trigger:"blur"}],status:[{required:!0,message:"请选择用户状态",trigger:"change"}],activeState:[{required:!0,message:"请选择用户激活状态",trigger:"change"}],enable:[{required:!0,message:"请选择用户是否启用",trigger:"change"}]}}},methods:{showModal:function(){this.title="新增用户",this.dialogVisible=!0},editUser:function(e){this.form=Object(i["a"])({},e),this.formerForm=Object(i["a"])({},e),this.title="编辑用户",this.dialogVisible=!0},handleClose:function(e){this.resetData()},submitForm:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return console.log("error submit!!"),!1;console.log(e.form),e.form.id?e.updatePlatformUser():e.createPlatformUser()}))},updatePlatformUser:function(){var e=this;this.btnLoading=!0;var t=Object(p["d"])(this.formerForm,this.form);m(t).then((function(t){"200"===t.code?(e.$emit("ok"),e.$message.success("用户修改成功"),e.resetData()):e.$message.error(t.data)})).finally((function(t){e.btnLoading=!1}))},createPlatformUser:function(){var e=this;this.btnLoading=!0,f(this.form).then((function(t){"200"===t.code?(e.$emit("ok"),e.$message.success("用户创建成功"),e.resetData()):e.$message.error(t.data)})).finally((function(t){e.btnLoading=!1}))},resetData:function(){this.dialogVisible=!1,this.title="",this.btnLoading=!1,this.form={email:"",userName:"",password:"",status:1,contactNo:"",company:"",profession:"",industry:"",activeState:"",locale:"中国",timeZone:'"UTC/GMT: +8:00"'}}}},g=b,h=a("2877"),v=Object(h["a"])(g,s,n,!1,null,"08015b58",null),w=v.exports,y={name:"RegisterUser",components:{userForm:w},data:function(){return{loading:!1,tableData:[],dbfields:!0,selectData:[],tableHeader:{color:"#d4dce3",background:"#4286CD"},fieldsTotal:0,fieldsQuery:{pageNum:1,pageSize:10}}},computed:{userInfo:function(){return this.$store.state.user.userinfo}},created:function(){this.getQueryPlatformUser()},methods:{refresh:function(){this.fieldsQuery.pageNum=1,this.getQueryPlatformUser()},addUser:function(){this.$refs.userForm.showModal(),this.getQueryPlatformUser()},deleteUser:function(){},userDel:function(e){var t=this;this.$confirm("是否确认删除用户?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){d(e.id).then((function(e){"200"===e.code&&(t.$message.success("用户删除成功"),t.refresh())}))}))},userEdit:function(e){console.log(e),this.$refs.userForm.editUser(e)},userSelectionChange:function(e){this.selectData=e,this.dbfields=!e.length},logout:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.remove("activeIndex"),t.next=3,e.$store.dispatch("user/logout");case 3:e.$router.push("/login?redirect=".concat(e.$route.fullPath));case 4:case"end":return t.stop()}}),t)})))()},getQueryPlatformUser:function(){var e=this;this.loading=!0,u(this.fieldsQuery).then((function(t){"200"===t.code&&(e.tableData=t.data,e.fieldsTotal=t.total)})).finally((function(t){e.loading=!1}))}}},k=y,$=(a("6124"),Object(h["a"])(k,r,o,!1,null,"eff3079e",null));t["default"]=$.exports}}]);