(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03ff4c30"],{"23a7":function(e,t,r){"use strict";r("bbba")},"24d2":function(e,t,r){"use strict";r.d(t,"o",(function(){return n})),r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return o})),r.d(t,"f",(function(){return l})),r.d(t,"c",(function(){return s})),r.d(t,"r",(function(){return c})),r.d(t,"m",(function(){return u})),r.d(t,"b",(function(){return d})),r.d(t,"s",(function(){return f})),r.d(t,"e",(function(){return p})),r.d(t,"k",(function(){return m})),r.d(t,"n",(function(){return v})),r.d(t,"j",(function(){return h})),r.d(t,"i",(function(){return b})),r.d(t,"l",(function(){return w})),r.d(t,"p",(function(){return g})),r.d(t,"q",(function(){return y})),r.d(t,"h",(function(){return j})),r.d(t,"g",(function(){return O}));var a=r("b775");function n(e,t){return Object(a["a"])({url:"/project/queryForProjects",method:"post",params:e,data:t})}function i(e){return Object(a["a"])({url:"/project/addProject",method:"post",data:e})}function o(e){return Object(a["a"])({url:"/project/deleteProject/"+e,method:"delete"})}function l(e){return Object(a["a"])({url:"/project/updateProject",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/project/checkProject/"+e,method:"get"})}function c(e,t){return Object(a["a"])({url:"/view/queryViews",method:"post",params:t,data:e})}function u(e){return Object(a["a"])({url:"/view/queryById/"+e,method:"get"})}function d(e){return Object(a["a"])({url:"/view/addViewRE",method:"post",data:e})}function f(e){return Object(a["a"])({url:"/view/updateView",method:"post",data:e})}function p(e){return Object(a["a"])({url:"/view/deleteView/"+e,method:"delete"})}function m(){return Object(a["a"])({url:"/view/getViewFilter",method:"post"})}function v(e){return Object(a["a"])({url:"/user/queryByNameSubUsers",method:"post",params:e})}function h(e){return Object(a["a"])({url:"/project/queryById/"+e,method:"get"})}function b(e){return Object(a["a"])({url:"/project/getCloseProject",method:"get",params:e})}function w(e){return Object(a["a"])({url:"/view/getViewScopeChildParams",method:"get",params:e})}function g(e){return Object(a["a"])({url:"/view/queryViewParents",method:"get",params:e})}function y(e){return Object(a["a"])({url:"/view/queryViewTrees",method:"get",params:e})}function j(){return Object(a["a"])({url:"/project/getAllSysCustomField",method:"get"})}function O(e){return Object(a["a"])({url:"/project/getAllCustomField",method:"post",data:e})}},"82ab":function(e,t,r){},8388:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container manage-view view"},[r("el-form",{ref:"from",staticClass:"demo-ruleForm",attrs:{model:e.from,rules:e.rules,"label-width":"100px"}},[r("div",{staticClass:"new_project"},[e.from.id?e._e():r("el-button",{attrs:{type:"primary",disabled:e.savedisabled,round:""},on:{click:function(t){return t.stopPropagation(),e.submitForm("from")}}},[e._v("新增")]),e.from.id?e._e():r("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return t.stopPropagation(),e.waiveForm("from")}}},[e._v("取消")]),e.from.id?r("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return t.stopPropagation(),e.submitForm("from")}}},[e._v("确定修改")]):e._e(),e.from.id?r("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return t.stopPropagation(),e.cancelUpdate("from")}}},[e._v("取消修改")]):e._e()],1),r("el-form-item",{staticClass:"form-small",attrs:{label:"视图标题:",prop:"title"}},[r("el-input",{attrs:{size:"small"},model:{value:e.from.title,callback:function(t){e.$set(e.from,"title",t)},expression:"from.title"}})],1),r("div",{staticClass:"scopeView"},[r("el-form-item",{staticClass:"form-small",attrs:{label:"范围:",prop:"scope"}},[r("el-select",{attrs:{size:"small",disabled:e.scopeDis,placeholder:"请选择适用范围"},on:{change:e.viewScopeChildParams},model:{value:e.from.scope,callback:function(t){e.$set(e.from,"scope",t)},expression:"from.scope"}},e._l(e.scopeOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{staticClass:"form-small",attrs:{label:"父级视图:",prop:"parent"}},[r("el-select",{attrs:{size:"small",filterable:"","filter-method":e.dataFilter,placeholder:"请选择父级视图"},on:{change:e.fuzhiFrom},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.queryViewParent(t)}},model:{value:e.viewParentQuery,callback:function(t){e.viewParentQuery=t},expression:"viewParentQuery"}},[e._l(e.viewParents,(function(e){return r("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),r("el-option",{attrs:{label:"无",value:"0"}})],2)],1)],1),r("el-form-item",{staticClass:"form-small wd200",attrs:{label:"自动创建子视图基于选项值:",prop:"filter"}},[r("el-checkbox",{on:{change:e.handleFilterChange},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1),e.filter?e._e():r("el-form-item",{attrs:{label:"查询条件:",prop:"oneFilters"}},[r("div",{staticClass:"filter-item"},[0===e.from.oneFilters.length?r("el-col",{attrs:{span:1}},[r("span",{on:{click:e.addFliter}},[r("i",{staticClass:"el-icon-circle-plus circle"})])]):e._e(),e._l(e.from.oneFilters,(function(t,a){return r("el-row",{key:a},[r("el-row",[r("el-col",{attrs:{span:2}},[r("span",{on:{click:e.addFliter}},[r("i",{staticClass:"el-icon-circle-plus  circle"})]),r("span",{on:{click:function(t){return e.delRemove(a)}}},[r("i",{staticClass:"el-icon-remove circle remove"})])]),r("el-col",{attrs:{span:4}},[r("el-select",{ref:"selectFiled",refInFor:!0,attrs:{size:"small",placeholder:"请选择字段"},on:{change:function(r){return e.getType(t.fieldName,a)}},model:{value:t.fieldName,callback:function(r){e.$set(t,"fieldName",r)},expression:"item.fieldName"}},e._l(e.scopeDownChildParams,(function(e){return r("el-option",{key:e.filedName,attrs:{label:e.filedNameCn,value:e.filedName}})})),1)],1),r("el-col",{attrs:{span:4}},[r("el-select",{ref:"selectFiled",refInFor:!0,attrs:{size:"small",placeholder:""},model:{value:t.condition,callback:function(r){e.$set(t,"condition",r)},expression:"item.condition"}},e._l(e.conditionList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),"fString"===t.type?r("el-col",{attrs:{span:4}},[r("el-input",{attrs:{size:"small"},model:{value:t.textVal,callback:function(r){e.$set(t,"textVal",r)},expression:"item.textVal"}})],1):"fInteger"===t.type?r("el-col",{attrs:{span:4}},[r("el-select",{attrs:{size:"small",placeholder:"请选择状态"},model:{value:t.textVal,callback:function(r){e.$set(t,"textVal",r)},expression:"item.textVal"}},e._l(e.statusDownChildParams,(function(e){return r("el-option",{key:e.optionValue,attrs:{label:e.optionValueCn,value:e.optionValue}})})),1)],1):r("el-col",{attrs:{span:6}},[r("el-date-picker",{attrs:{type:"datetime",size:"small",placeholder:"开始日期"},model:{value:t.beginDate,callback:function(r){e.$set(t,"beginDate",r)},expression:"item.beginDate"}}),r("el-date-picker",{attrs:{type:"datetime",size:"small",placeholder:"结束日期"},model:{value:t.endDate,callback:function(r){e.$set(t,"endDate",r)},expression:"item.endDate"}})],1)],1),r("el-row",[r("el-col",{attrs:{span:2}},[e._v("~ ")]),r("el-col",{attrs:{span:3}},[r("el-radio",{attrs:{label:"and"},model:{value:t.andOr,callback:function(r){e.$set(t,"andOr",r)},expression:"item.andOr"}},[e._v("并且")]),r("el-radio",{attrs:{label:"or"},model:{value:t.andOr,callback:function(r){e.$set(t,"andOr",r)},expression:"item.andOr"}},[e._v("或者")])],1)],1)],1)}))],2)]),r("el-form-item",{staticClass:"form-small",attrs:{label:"视图状态:",prop:"isPrivate"}},[r("el-radio",{attrs:{label:"0"},model:{value:e.from.isPrivate,callback:function(t){e.$set(e.from,"isPrivate",t)},expression:"from.isPrivate"}},[e._v("仅自己")]),r("el-radio",{attrs:{label:"1"},model:{value:e.from.isPrivate,callback:function(t){e.$set(e.from,"isPrivate",t)},expression:"from.isPrivate"}},[e._v("公开")])],1)],1),r("div",{staticClass:"table"},[r("el-button",{attrs:{type:"text"},on:{click:e.viewjectRefresh}},[e._v("刷新")]),r("el-button",{attrs:{type:"text",disabled:e.multiple},on:{click:function(t){return e.delview("all")}}},[e._v("批量删除")]),r("el-table",{ref:"viewData",staticStyle:{width:"100%"},attrs:{data:e.viewData,"header-cell-style":e.tableHeader,stripe:""},on:{"row-click":e.toEdit,"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),r("el-table-column",{attrs:{prop:"title","show-overflow-tooltip":!0,align:"left",width:"155",label:e.$t("lang.CommonFiled.Title")},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticClass:"title",on:{click:function(r){return e.toEdit(t.row)}}},[e._v(" "+e._s(t.row.title)+" ")])]}}])}),r("el-table-column",{attrs:{prop:"scope",label:"范围"}}),r("el-table-column",{attrs:{prop:"status",label:"视图状态"}}),r("el-table-column",{attrs:{prop:"parentTitle",label:"父级视图"}}),r("el-table-column",{attrs:{prop:"owner",label:"创建者"}}),r("el-table-column",{attrs:{prop:"createTime",label:"创建日期"}}),r("el-table-column",{attrs:{prop:"modifier",label:"修改者"}}),r("el-table-column",{attrs:{prop:"updateTime",label:"修改日期"}}),r("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{staticClass:"table-btn",attrs:{type:"text"},on:{click:function(r){return r.stopPropagation(),e.delview(t.row.id)}}},[e._v("删除")])]}}])})],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.viewTotal>0,expression:"viewTotal > 0"}],attrs:{total:e.viewTotal,page:e.viewQuery.pageNum,limit:e.viewQuery.pageSize},on:{"update:page":function(t){return e.$set(e.viewQuery,"pageNum",t)},"update:limit":function(t){return e.$set(e.viewQuery,"pageSize",t)},pagination:e.getqueryViews}})],1)],1)},n=[],i=r("1da1"),o=r("5530"),l=(r("d3b7"),r("159b"),r("ac1f"),r("1276"),r("498a"),r("a434"),r("96cf"),r("cf45")),s=r("24d2"),c=r("2f62"),u={name:"Projectview",data:function(){return{scopeOptions:[{value:"Project",label:"项目"},{value:"Feature",label:"故事"},{value:"Sprint",label:"迭代"},{value:"TestCase",label:"测试用例"},{value:"TestCycle",label:"测试周期"},{value:"Issue",label:"缺陷"}],scopeDownChildParams:[],statusDownChildParams:[],savedisabled:!0,from:{isPrivate:"0",oneFilters:[]},fromTemp:{},scopeDis:!1,rules:{title:[{required:!0,message:"请输入视图名称",trigger:"blur"}]},tableHeader:{color:"#d4dce3",background:"#4286CD"},viewQuery:{pageNum:1,pageSize:10},viewBody:{scope:"",projectId:""},viewParentQuery:"0",viewParents:[],viewTotal:0,viewData:[],multipleSelection:[],multiple:!0,viewId:"",conditionList:[],filter:!1}},computed:Object(o["a"])(Object(o["a"])({},Object(c["c"])({nvaName:function(e){return e.common.nvaName}})),{},{projectInfo:function(){return this.$store.state.user.userinfo}}),watch:{"from.title":function(e){this.savedisabled=!e}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.viewBody.projectId=e.projectInfo.userUseOpenProject.projectId,t.next=3,e.initScope();case 3:return t.next=5,e.getqueryViews();case 5:e.getViewFilter();case 6:case"end":return t.stop()}}),t)})))()},methods:{handleFilterChange:function(e){e&&(this.from.oneFilters=[])},getViewFilter:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["k"])();case 2:r=t.sent,"200"===r.code&&r.data.forEach((function(t){var r={value:t.split(",")[1],label:t.split(",")[0]};e.conditionList.push(r)}));case 4:case"end":return t.stop()}}),t)})))()},initScope:function(){var e=this;e.viewBody.scope=e.nvaName,"Feature"!==e.nvaName&&"Sprint"!==e.nvaName&&"TestCase"!==e.nvaName&&"TestCycle"!==e.nvaName&&"Issue"!==e.nvaName&&(e.viewBody.scope="Project")},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;if(t.from.id){var r=Object(l["d"])(t.fromTemp,t.from);r.oneFilters=t.from.oneFilters,r.scope=t.from.scope,Object(s["s"])(r).then((function(e){"200"===e.code&&(Object(l["e"])("success",e.msg),t.cancelUpdate(),t.getqueryViews())}))}else Object(s["b"])(t.from).then((function(e){"200"===e.code&&(t.resetForm(),Object(l["e"])("success",e.msg),t.getqueryViews())}))}))},waiveForm:function(){Object(l["f"])(this,1e3)},cancelUpdate:function(){this.$refs.viewData.clearSelection(),this.resetForm(),this.viewId=""},resetForm:function(){this.from={id:void 0,isPrivate:"0",oneFilters:[],title:""},this.scopeDis=!1,this.$refs["from"].resetFields()},handleSelectionChange:function(e){this.multipleSelection=e,this.multiple=!e.length},toEdit:function(e){var t=this;this.$refs.viewData.clearSelection(),this.viewId=e.id,this.viewParentQuery="0",this.$refs.viewData.toggleRowSelection(e),this.searchViewInfo(),void 0!==e.parentTitle&&""!==e.parentTitle&&(this.viewParentQuery=e.parentTitle);var r={scope:e.scope};Object(s["l"])(r).then((function(e){t.scopeDownChildParams=e.data}))},searchViewInfo:function(){var e=this;Object(s["m"])(this.viewId).then((function(t){"200"===t.code&&(0===t.data.isPrivate?t.data.isPrivate="0":t.data.isPrivate="1",e.from=t.data,e.scopeDis=!0,e.fromTemp=Object.assign({},e.from))}))},delview:function(e){var t=this;"all"!==e?Object(s["e"])(e).then((function(e){Object(l["e"])("success",e.msg),t.getqueryViews(),t.cancelUpdate()})):Object(l["e"])("error","暂未开发")},getqueryViews:function(){var e=this;return new Promise((function(t,r){Object(s["r"])(e.viewBody,e.viewQuery).then((function(r){"200"===r.code&&(e.viewData=r.data,e.viewTotal=r.total,t(r))}))}))},viewjectRefresh:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getqueryViews();case 2:r=t.sent,"200"===r.code&&Object(l["e"])("success","刷新成功");case 4:case"end":return t.stop()}}),t)})))()},addFliter:function(){if(void 0!==this.from.scope&&""!==this.from.scope.trim()){var e={andOr:"and",beginDate:"",endDate:"",fieldName:"",intVal:"",sourceVal:"",textVal:"",condition:"",type:"fString"};this.from.oneFilters.push(e)}else Object(l["e"])("warning","请选择作用域")},delRemove:function(e){this.from.oneFilters.splice(e,1)},getType:function(e,t){for(var r=0;r<this.scopeDownChildParams.length;r++){var a=this.scopeDownChildParams[r];if(a.filedName===e)return void 0!==a.selectChild&&a.selectChild.length>0&&(console.log("statusDownChildParams",this.statusDownChildParams),this.statusDownChildParams=a.selectChild),void(this.from.oneFilters[t].type=a.type)}},viewScopeChildParams:function(){var e=this;this.from.oneFilters.length>0&&this.$confirm("重新选择可能会丢失页面内容请确认？",{title:"提示",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(t){e.from.oneFilters=[]})).catch((function(t){e.$router.go(0)}));var t={scope:this.from.scope};Object(s["l"])(t).then((function(t){e.scopeDownChildParams=t.data}))},dataFilter:function(e){this.viewParentQuery=e},queryViewParent:function(){var e=this;if(void 0===this.from.scope||""===this.from.scope)return Object(l["e"])("success","请选择作用域"),void(this.viewParentQuery="0");var t={viewTitle:this.viewParentQuery,scope:this.from.scope};Object(s["p"])(t).then((function(t){e.viewParents=t.data}))},fuzhiFrom:function(e){this.from.parentId=e}}},d=u,f=(r("23a7"),r("e4cb"),r("2877")),p=Object(f["a"])(d,a,n,!1,null,"49d3a10c",null);t["default"]=p.exports},a434:function(e,t,r){"use strict";var a=r("23e7"),n=r("23cb"),i=r("a691"),o=r("50c4"),l=r("7b0b"),s=r("65f0"),c=r("8418"),u=r("1dde"),d=r("ae40"),f=u("splice"),p=d("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,v=Math.min,h=9007199254740991,b="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!f||!p},{splice:function(e,t){var r,a,u,d,f,p,w=l(this),g=o(w.length),y=n(e,g),j=arguments.length;if(0===j?r=a=0:1===j?(r=0,a=g-y):(r=j-2,a=v(m(i(t),0),g-y)),g+r-a>h)throw TypeError(b);for(u=s(w,a),d=0;d<a;d++)f=y+d,f in w&&c(u,d,w[f]);if(u.length=a,r<a){for(d=y;d<g-a;d++)f=d+a,p=d+r,f in w?w[p]=w[f]:delete w[p];for(d=g;d>g-a+r;d--)delete w[d-1]}else if(r>a)for(d=g-a;d>y;d--)f=d+a-1,p=d+r-1,f in w?w[p]=w[f]:delete w[p];for(d=0;d<r;d++)w[d+y]=arguments[d+2];return w.length=g-a+r,u}})},bbba:function(e,t,r){},e4cb:function(e,t,r){"use strict";r("82ab")}}]);