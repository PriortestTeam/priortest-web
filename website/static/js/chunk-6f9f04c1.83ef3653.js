(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f9f04c1"],{"00b3":function(e,t,r){},"24d2":function(e,t,r){"use strict";r.d(t,"o",(function(){return n})),r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return a})),r.d(t,"f",(function(){return l})),r.d(t,"c",(function(){return s})),r.d(t,"r",(function(){return u})),r.d(t,"m",(function(){return c})),r.d(t,"b",(function(){return d})),r.d(t,"s",(function(){return f})),r.d(t,"e",(function(){return p})),r.d(t,"k",(function(){return m})),r.d(t,"n",(function(){return h})),r.d(t,"j",(function(){return b})),r.d(t,"i",(function(){return g})),r.d(t,"l",(function(){return v})),r.d(t,"p",(function(){return j})),r.d(t,"q",(function(){return F})),r.d(t,"h",(function(){return O})),r.d(t,"g",(function(){return y}));var o=r("b775");function n(e,t){return Object(o["a"])({url:"/project/queryForProjects",method:"post",params:e,data:t})}function i(e){return Object(o["a"])({url:"/project/addProject",method:"post",data:e})}function a(e){return Object(o["a"])({url:"/project/deleteProject/"+e,method:"delete"})}function l(e){return Object(o["a"])({url:"/project/updateProject",method:"post",data:e})}function s(e){return Object(o["a"])({url:"/project/checkProject/"+e,method:"get"})}function u(e,t){return Object(o["a"])({url:"/view/queryViews",method:"post",params:t,data:e})}function c(e){return Object(o["a"])({url:"/view/queryById/"+e,method:"get"})}function d(e){return Object(o["a"])({url:"/view/addViewRE",method:"post",data:e})}function f(e){return Object(o["a"])({url:"/view/updateView",method:"post",data:e})}function p(e){return Object(o["a"])({url:"/view/deleteView/"+e,method:"delete"})}function m(){return Object(o["a"])({url:"/view/getViewFilter",method:"post"})}function h(e){return Object(o["a"])({url:"/user/queryByNameSubUsers",method:"post",params:e})}function b(e){return Object(o["a"])({url:"/project/queryById/"+e,method:"get"})}function g(e){return Object(o["a"])({url:"/project/getCloseProject",method:"get",params:e})}function v(e){return Object(o["a"])({url:"/view/getViewScopeChildParams",method:"get",params:e})}function j(e){return Object(o["a"])({url:"/view/queryViewParents",method:"get",params:e})}function F(e){return Object(o["a"])({url:"/view/queryViewTrees",method:"get",params:e})}function O(){return Object(o["a"])({url:"/project/getAllSysCustomField",method:"get"})}function y(e){return Object(o["a"])({url:"/project/getAllCustomField",method:"post",data:e})}},4703:function(e,t,r){"use strict";r.d(t,"f",(function(){return n})),r.d(t,"g",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return l})),r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"b",(function(){return c})),r.d(t,"h",(function(){return d}));var o=r("b775");function n(e,t){return Object(o["a"])({url:"/feature/queryList",method:"post",params:e,data:t})}function i(e){return Object(o["a"])({url:"/leftJoin/queryFeatureTitles",method:"get",params:e})}function a(e){return Object(o["a"])({url:"/feature/insert",method:"post",data:e})}function l(e){return Object(o["a"])({url:"/feature/queryById/"+e,method:"get"})}function s(e){return Object(o["a"])({url:"/feature/delete/"+e,method:"delete"})}function u(e){return Object(o["a"])({url:"/feature/update",method:"post",data:e})}function c(e){return Object(o["a"])({url:"/feature/closeUpdate",method:"post",params:e})}function d(e){return Object(o["a"])({url:"/feature/querySprintList",method:"post",params:e})}},"6f80":function(e,t,r){},"9d23":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container add-form add-project"},[r("el-form",{ref:"featureFrom",staticClass:"demo-ruleForm",attrs:{model:e.featureFrom,rules:e.Projectrules,"label-width":"120px"}},[r("div",[e.featureFrom.id?e._e():r("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return e.submitForm("featureFrom",!1)}}},[e._v("保存并新建")]),e.featureFrom.id?e._e():r("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return e.submitForm("featureFrom",!0)}}},[e._v("保存并返回")]),e.featureFrom.id?r("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return e.submitForm("featureFrom")}}},[e._v("确认修改")]):e._e(),r("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return e.giveupBack("featureFrom")}}},[e._v("放弃")]),e.featureFrom.id?e._e():r("router-link",{attrs:{to:"/admincenter/admincenter"}},[r("el-button",{attrs:{type:"text"}},[e._v(e._s(e.$t("lang.PublicBtn.CreateCustomField")))])],1)],1),r("div",{staticClass:"form-box"},[r("el-form-item",{attrs:{label:e.$t("lang.Feature.FeatureTitle"),prop:"title"}},[r("el-input",{attrs:{maxlength:"50",size:"small"},model:{value:e.featureFrom.title,callback:function(t){e.$set(e.featureFrom,"title",t)},expression:"featureFrom.title"}})],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"负责人",size:"small",prop:"reportTo"}},[r("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请选择负责人",clearable:"","remote-method":e.remoteReport,loading:e.loading},model:{value:e.featureFrom.reportTo,callback:function(t){e.$set(e.featureFrom,"reportTo",t)},expression:"featureFrom.reportTo"}},e._l(e.optionsArr,(function(e){return r("el-option",{key:e.id,attrs:{label:e.userName,value:e.userName}})})),1)],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"small",label:e.$t("lang.CommonFiled.Version"),prop:"version"}},[r("el-select",{attrs:{placeholder:"请选择版本",clearable:""},model:{value:e.featureFrom.version,callback:function(t){e.$set(e.featureFrom,"version",t)},expression:"featureFrom.version"}},[e._l(e.versionsArr,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),r("router-link",{attrs:{to:"/admincenter/admincenter?par=versions"}},[r("el-option",{attrs:{label:"添加新值",value:0}})],1)],2)],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"small",label:"迭代周期",prop:"sprintId"}},[r("el-select",{attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"请选择迭代周期","remote-method":e.remoteMethod,loading:e.loading},on:{change:e.getTag},model:{value:e.featureFrom.sprintId,callback:function(t){e.$set(e.featureFrom,"sprintId",t)},expression:"featureFrom.sprintId"}},e._l(e.sprintArr,(function(e){return r("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"small",label:"EPIC",prop:"epic"}},[r("el-select",{attrs:{placeholder:"请选择epic",clearable:""},model:{value:e.featureFrom.epic,callback:function(t){e.$set(e.featureFrom,"epic",t)},expression:"featureFrom.epic"}},[e._l(e.epicArr,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),r("router-link",{attrs:{to:"/admincenter/admincenter?par=epic"}},[r("el-option",{attrs:{label:"Add New Value",value:0}})],1)],2)],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"small",label:"模块",prop:"moudle"}},[r("el-select",{attrs:{placeholder:"请选择模块",clearable:""},model:{value:e.featureFrom.moudle,callback:function(t){e.$set(e.featureFrom,"moudle",t)},expression:"featureFrom.moudle"}},[e._l(e.moudleArr,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),r("router-link",{attrs:{to:"/admincenter/admincenter?par=moudle"}},[r("el-option",{attrs:{label:"Add New Value",value:0}})],1)],2)],1)],1)],1),r("el-form-item",{attrs:{label:e.$t("lang.Project.Description"),prop:"description",size:"small"}},[r("el-input",{attrs:{type:"textarea",maxlength:"1000","show-word-limit":"",autosize:{minRows:3,maxRows:8}},model:{value:e.featureFrom.description,callback:function(t){e.$set(e.featureFrom,"description",t)},expression:"featureFrom.description"}})],1)],1),r("div",{staticClass:"tag-box"},[r("b",[e._v("关联迭代周期列表")]),e._l(e.featureFrom.sprints,(function(t){return r("el-tag",{key:t.id,attrs:{closable:"",type:"success"},on:{close:function(r){return e.removeTag(t.id)}}},[e._v(" "+e._s(t.title)+" ")])})),0===e.featureFrom.sprints.length?r("div",{staticClass:"nodata"},[e._v(" 暂无关联！ ")]):e._e()],2)]),e.featureFrom.id?r("div",{staticClass:"table"},[r("Upload",{attrs:{"link-id":e.featureFrom.id,type:e.featureFrom.scope}})],1):e._e()],1)},n=[],i=r("5530"),a=(r("d3b7"),r("159b"),r("c740"),r("a434"),r("2f62")),l=r("c7f0"),s=r("24d2"),u=r("4703"),c=r("cf45"),d=r("f5dd"),f={name:"Addfeature",components:{Upload:l["a"]},data:function(){return{optionsArr:[],getOptionsArr:["versions","epic","moudle"],versionsArr:[],epicArr:[],moudleArr:[],loading:!1,sprintArr:[],featureFrom:{sprintId:"",sprints:[]},featureFromTemp:{},Projectrules:{title:[{required:!0,message:"请输入故事标题",trigger:"blur"}],reportTo:[{required:!0,message:"请输入负责人",trigger:"blur"}]},profileOpen:!1,tableHeader:{color:"#d4dce3",background:"#4286CD"},editfileList:[],onefileList:[],onefileId:"",allfileList:[],fileTotal:0,fileParams:{pageNum:1,pageSize:10,type:"Project",linkId:""}}},computed:Object(i["a"])(Object(i["a"])({},Object(a["b"])({lang:function(e){return e.header.lang}})),{},{projectInfo:function(){return this.$store.state.user.userinfo}}),created:function(){var e=this;this.$route.query.id?Object(u["d"])(this.$route.query.id).then((function(t){e.featureFrom=t.data,e.featureFromTemp=Object.assign({},e.featureFrom),e.fileParams.type=t.data.scope,e.fileParams.linkId=t.data.id})):(this.featureFrom.projectId=this.projectInfo.userUseOpenProject.projectId,this.fileParams.linkId=this.projectInfo.userUseOpenProject.projectId),this.getOptionsArr.forEach((function(t){Object(d["a"])({fieldName:t}).then((function(r){var o=r.data.mergeValues?r.data.mergeValues:[];"moudle"===t&&(e.moudleArr=o),"epic"===t&&(e.epicArr=o),"versions"===t&&(e.versionsArr=o)}))}))},mounted:function(){},methods:{resetFields:function(){this.featureFrom={id:void 0,projectId:this.projectInfo.userUseOpenProject.projectId,title:void 0,description:void 0,moudle:void 0,sprintId:[],sprints:[],reportTo:void 0,epic:void 0,version:void 0},this.$refs["featureFrom"].resetFields()},remoteMethod:function(e){var t=this;""!==e?(this.loading=!0,setTimeout((function(){t.loading=!1,Object(u["h"])({title:e}).then((function(e){t.sprintArr=e.data}))}),200)):this.sprintArr=[]},remoteReport:function(e){var t=this;""!==e?(this.loading=!0,setTimeout((function(){t.loading=!1,Object(s["n"])({subUserName:e}).then((function(e){t.optionsArr=e.data}))}),200)):this.optionsArr=[]},getTag:function(){var e=this,t=this.featureFrom.sprints.findIndex((function(t){return t.id===e.featureFrom.sprintId}));if(-1===t){var r=this.sprintArr.findIndex((function(t){return t.id===e.featureFrom.sprintId}));this.featureFrom.sprints.push(this.sprintArr[r])}else Object(c["e"])("error","该迭代周期已选择");this.featureFrom.sprintId=""},removeTag:function(e){var t=this.sprintArr.findIndex((function(t){return t.id===e}));this.featureFrom.sprints.splice(t,1)},submitForm:function(e,t){var r=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;if(delete r.featureFrom.sprintId,r.featureFrom.id){var o=Object(c["d"])(r.featureFromTemp,r.featureFrom);o.projectId=r.featureFrom.projectId,o.sprints=r.featureFrom.sprints,Object(u["e"])(o).then((function(e){"200"===e.code&&(Object(c["e"])("success",e.msg),Object(c["f"])(r,1e3))})).catch((function(e){console.log(e)}))}else Object(u["a"])(r.featureFrom).then((function(e){"200"===e.code?(Object(c["e"])("success",e.msg),r.resetFields(),t&&Object(c["f"])(r,1e3)):Object(c["e"])("error",e.msg)})).catch((function(e){console.log(e)}))}))},giveupBack:function(){this.featureFrom.id||this.resetFields(),this.returntomenu(this)}}},p=f,m=(r("d1fc"),r("2877")),h=Object(m["a"])(p,o,n,!1,null,"29459c31",null);t["default"]=h.exports},a434:function(e,t,r){"use strict";var o=r("23e7"),n=r("23cb"),i=r("a691"),a=r("50c4"),l=r("7b0b"),s=r("65f0"),u=r("8418"),c=r("1dde"),d=r("ae40"),f=c("splice"),p=d("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,h=Math.min,b=9007199254740991,g="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!f||!p},{splice:function(e,t){var r,o,c,d,f,p,v=l(this),j=a(v.length),F=n(e,j),O=arguments.length;if(0===O?r=o=0:1===O?(r=0,o=j-F):(r=O-2,o=h(m(i(t),0),j-F)),j+r-o>b)throw TypeError(g);for(c=s(v,o),d=0;d<o;d++)f=F+d,f in v&&u(c,d,v[f]);if(c.length=o,r<o){for(d=F;d<j-o;d++)f=d+o,p=d+r,f in v?v[p]=v[f]:delete v[p];for(d=j;d>j-o+r;d--)delete v[d-1]}else if(r>o)for(d=j-o;d>F;d--)f=d+o-1,p=d+r-1,f in v?v[p]=v[f]:delete v[p];for(d=0;d<r;d++)v[d+F]=arguments[d+2];return v.length=j-o+r,c}})},c7f0:function(e,t,r){"use strict";var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-upload",{staticClass:"upload-demo",attrs:{action:"","http-request":e.HandleUploadSelf,multiple:"","file-list":e.allfileList}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("附件")])],1),r("el-table",{ref:"allfileList",staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.allfileList,"header-cell-style":e.tableHeader,stripe:""}},[r("el-table-column",{attrs:{prop:"fileName","show-overflow-tooltip":!0,align:"center",label:"文件名称"}}),r("el-table-column",{attrs:{prop:"uploader",align:"center",label:"上传者"}}),r("el-table-column",{attrs:{prop:"modifyTime",align:"center",label:"更新时间","min-width":"120","show-overflow-tooltip":!0}}),r("el-table-column",{attrs:{label:"操作","min-width":"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{staticClass:"table-btn",attrs:{type:"text"},on:{click:function(r){return r.stopPropagation(),e.openfildEdit(t.row.id)}}},[e._v("编辑")]),r("el-button",{staticClass:"table-btn",attrs:{type:"text"},on:{click:function(r){return r.stopPropagation(),e.openfildDel(t.row.id)}}},[e._v("删除")])]}}])})],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.fileTotal>0,expression:"fileTotal > 0"}],attrs:{total:e.fileTotal,page:e.fileParams.pageNum,limit:e.fileParams.pageSize},on:{"update:page":function(t){return e.$set(e.fileParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.fileParams,"pageSize",t)},pagination:e.getfileList}}),r("el-dialog",{attrs:{title:"修改附件",visible:e.profileOpen,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.profileOpen=t}}},[r("div",[r("el-upload",{staticClass:"editupload-demo",attrs:{action:"","http-request":e.editUploadSelf,"before-remove":e.editbeforeRemove,multiple:"",limit:1,"on-exceed":e.editExceed,"file-list":e.editfileList}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("重新上传")])],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.fileSubForm}},[e._v("确 定")]),r("el-button",{on:{click:e.calloff}},[e._v("取消")])],1)])],1)},n=[],i=(r("4de4"),r("d3b7"),r("b0c0"),r("99af"),r("cf45")),a=r("b775");function l(e,t){return Object(a["a"])({url:"/attachment/addAttachment",method:"post",params:e,data:t})}function s(e){return Object(a["a"])({url:"/attachment/list",method:"get",params:e})}function u(e){return Object(a["a"])({url:"/attachment/deleteAttachment/"+e,method:"delete"})}function c(e,t){return Object(a["a"])({url:"/attachment/updateAttachment/"+e,method:"post",data:t})}var d={name:"Upload",props:{linkId:{required:!0,type:String},type:{required:!0,type:String}},data:function(){return{profileOpen:!1,tableHeader:{color:"#d4dce3",background:"#4286CD"},editfileList:[],onefileList:[],onefileId:"",allfileList:[],fileTotal:0,fileParams:{pageNum:1,pageSize:10,type:"",linkId:""}}},created:function(){this.fileParams.type=this.type,this.fileParams.linkId=this.linkId,console.log(this.type,this.linkId),this.getfileList()},methods:{HandleUploadSelf:function(e){var t=this,r={type:this.type,linkId:this.linkId};l(r,Object(i["c"])({file:e.file})).then((function(e){"200"===e.code&&(Object(i["e"])("success",e.msg),t.getfileList())}))},getfileList:function(){var e=this;s(this.fileParams).then((function(t){"200"===t.code&&(t.data.filter((function(e){e["name"]=e.fileName})),e.allfileList=t.data,e.fileTotal=t.total)}))},openfildEdit:function(e){this.profileOpen=!0,this.onefileId=e},editExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},editbeforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},editUploadSelf:function(e,t){this.onefileList=e},fileSubForm:function(){var e=this;this.profileOpen=!1,c(this.onefileId,Object(i["c"])({file:this.onefileList.file})).then((function(t){"200"===t.code&&(Object(i["e"])("success",t.msg),e.onefileList=[],e.editfileList=[],e.getfileList())}))},calloff:function(){this.profileOpen=!1},openfildDel:function(e){var t=this;u(e).then((function(e){"200"===e.code&&(Object(i["e"])("success",e.msg),t.getfileList())}))}}},f=d,p=(r("f987"),r("2877")),m=Object(p["a"])(f,o,n,!1,null,"76a50506",null);t["a"]=m.exports},d1fc:function(e,t,r){"use strict";r("6f80")},f5dd:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var o=r("b775");function n(e){return Object(o["a"])({url:"/sysCustomField/getSysCustomField",method:"get",params:e})}},f987:function(e,t,r){"use strict";r("00b3")}}]);