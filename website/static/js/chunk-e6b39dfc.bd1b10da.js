(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e6b39dfc"],{"00b3":function(e,t,r){},"24d2":function(e,t,r){"use strict";r.d(t,"o",(function(){return a})),r.d(t,"a",(function(){return n})),r.d(t,"d",(function(){return i})),r.d(t,"f",(function(){return l})),r.d(t,"c",(function(){return c})),r.d(t,"r",(function(){return s})),r.d(t,"m",(function(){return u})),r.d(t,"b",(function(){return p})),r.d(t,"s",(function(){return d})),r.d(t,"e",(function(){return m})),r.d(t,"k",(function(){return f})),r.d(t,"n",(function(){return b})),r.d(t,"j",(function(){return j})),r.d(t,"i",(function(){return h})),r.d(t,"l",(function(){return g})),r.d(t,"p",(function(){return v})),r.d(t,"q",(function(){return F})),r.d(t,"h",(function(){return y})),r.d(t,"g",(function(){return w}));var o=r("b775");function a(e,t){return Object(o["a"])({url:"/project/queryForProjects",method:"post",params:e,data:t})}function n(e){return Object(o["a"])({url:"/project/addProject",method:"post",data:e})}function i(e){return Object(o["a"])({url:"/project/deleteProject/"+e,method:"delete"})}function l(e){return Object(o["a"])({url:"/project/updateProject",method:"post",data:e})}function c(e){return Object(o["a"])({url:"/project/checkProject/"+e,method:"get"})}function s(e,t){return Object(o["a"])({url:"/view/queryViews",method:"post",params:t,data:e})}function u(e){return Object(o["a"])({url:"/view/queryById/"+e,method:"get"})}function p(e){return Object(o["a"])({url:"/view/addViewRE",method:"post",data:e})}function d(e){return Object(o["a"])({url:"/view/updateView",method:"post",data:e})}function m(e){return Object(o["a"])({url:"/view/deleteView/"+e,method:"delete"})}function f(){return Object(o["a"])({url:"/view/getViewFilter",method:"post"})}function b(e){return Object(o["a"])({url:"/user/queryByNameSubUsers",method:"post",params:e})}function j(e){return Object(o["a"])({url:"/project/queryById/"+e,method:"get"})}function h(e){return Object(o["a"])({url:"/project/getCloseProject",method:"get",params:e})}function g(e){return Object(o["a"])({url:"/view/getViewScopeChildParams",method:"get",params:e})}function v(e){return Object(o["a"])({url:"/view/queryViewParents",method:"get",params:e})}function F(e){return Object(o["a"])({url:"/view/queryViewTrees",method:"get",params:e})}function y(){return Object(o["a"])({url:"/project/getAllSysCustomField",method:"get"})}function w(e){return Object(o["a"])({url:"/project/getAllCustomField",method:"post",data:e})}},"348f":function(e,t,r){"use strict";r("3dfd")},"3dfd":function(e,t,r){},8467:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container add-form add-project"},[r("el-form",{ref:"projectFrom",staticClass:"demo-ruleForm",attrs:{model:e.projectFrom,rules:e.ProjectRules,"label-width":"120px","label-position":"top"}},[r("div",[e.projectFrom.id?e._e():r("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return e.submitForm("projectFrom",!1)}}},[e._v("保存并新建")]),e.projectFrom.id?e._e():r("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return e.submitForm("projectFrom",!0)}}},[e._v("保存并返回")]),e.projectFrom.id?r("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return e.submitForm("projectFrom")}}},[e._v("确认修改")]):e._e(),r("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return e.giveupBack("projectFrom")}}},[e._v("放弃")]),e.projectFrom.id?r("router-link",{attrs:{to:"/admincenter/admincenter"}},[r("el-button",{attrs:{type:"text"}},[e._v(e._s(e.$t("lang.PublicBtn.CreateCustomField")))])],1):e._e()],1),r("div",{staticClass:"form-box"},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:e.$t("lang.Project.ProjectTitle"),prop:"title"}},[r("el-input",{attrs:{maxlength:"20"},model:{value:e.projectFrom.title,callback:function(t){e.$set(e.projectFrom,"title",t)},expression:"projectFrom.title"}})],1)],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("lang.Project.Status"),prop:"status"}},[r("el-select",{attrs:{placeholder:"请选择项目状态",clearable:""},model:{value:e.projectFrom.status,callback:function(t){e.$set(e.projectFrom,"status",t)},expression:"projectFrom.status"}},[e._l(e.statusListArr,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),r("router-link",{attrs:{to:"/admincenter/admincenter?par=customer_list"}},[r("el-option",{attrs:{label:"添加新值",value:"0"}})],1)],2)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("lang.Project.ReportTo"),prop:"reportToName"}},[r("el-select",{attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"请选择负责人"},model:{value:e.projectFrom.reportToName,callback:function(t){e.$set(e.projectFrom,"reportToName",t)},expression:"projectFrom.reportToName"}},[e._l(e.reportToNameArr,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),r("router-link",{attrs:{to:"/admincenter/admincenter?par=report_name"}},[r("el-option",{attrs:{label:"添加新值",value:"0"}})],1)],2)],1)],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("lang.Project.Customer"),prop:"customer"}},[r("el-select",{attrs:{placeholder:"请选择客户",clearable:""},model:{value:e.projectFrom.customer,callback:function(t){e.$set(e.projectFrom,"customer",t)},expression:"projectFrom.customer"}},[e._l(e.customerListArr,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),r("router-link",{attrs:{to:"/admincenter/admincenter?par=customer_list"}},[r("el-option",{attrs:{label:"添加新值",value:"0"}})],1)],2)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("lang.Project.TestFrame"),prop:"testFrame"}},[r("el-select",{attrs:{placeholder:"请选择测试框架",clearable:""},model:{value:e.projectFrom.testFrame,callback:function(t){e.$set(e.projectFrom,"testFrame",t)},expression:"projectFrom.testFrame"}},[e._l(e.testFrameArr,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),r("router-link",{attrs:{to:"/admincenter/admincenter?par=test_frame"}},[r("el-option",{attrs:{label:"添加新值",value:"0"}})],1)],2)],1)],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("lang.Project.ProjectCategory"),prop:"projectCategory"}},[r("el-select",{attrs:{placeholder:"请选择项目类别",clearable:""},model:{value:e.projectFrom.projectCategory,callback:function(t){e.$set(e.projectFrom,"projectCategory",t)},expression:"projectFrom.projectCategory"}},[e._l(e.projectCategory,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),r("router-link",{attrs:{to:"/admincenter/admincenter?par=project_category"}},[r("el-option",{attrs:{label:"添加新值",value:"0"}})],1)],2)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("lang.Project.planReleaseDate"),prop:"planReleaseDate"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions,type:"date",placeholder:"选择上线日期"},model:{value:e.projectFrom.planReleaseDate,callback:function(t){e.$set(e.projectFrom,"planReleaseDate",t)},expression:"projectFrom.planReleaseDate"}})],1)],1)],1),e.projectFrom.id?r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"key",prop:"key"}},[r("el-input",{attrs:{disabled:!0,maxlength:"20"},model:{value:e.projectFrom.foreignId,callback:function(t){e.$set(e.projectFrom,"foreignId",t)},expression:"projectFrom.foreignId"}})],1)],1)],1):e._e(),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:e.$t("lang.Project.Description"),prop:"description"}},[r("el-input",{attrs:{type:"textarea",maxlength:"1000","show-word-limit":"",autosize:{minRows:3,maxRows:8}},model:{value:e.projectFrom.description,callback:function(t){e.$set(e.projectFrom,"description",t)},expression:"projectFrom.description"}})],1)],1)],1)],1)]),e.projectFrom.id?r("div",{staticClass:"table"},[r("Upload",{attrs:{"link-id":e.projectFrom.id,type:e.projectFrom.scope}})],1):e._e()],1)},a=[],n=r("1da1"),i=r("5530"),l=(r("d3b7"),r("159b"),r("96cf"),r("2f62")),c=r("24d2"),s=r("cf45"),u=r("c7f0"),p={name:"Addproject",components:{Upload:u["a"]},data:function(){return{disabled:!1,optionsArr:[],testFrameArr:[],reportToNameArr:[],customerListArr:[],projectCategory:[],statusListArr:[],loading:!1,projectFrom:{},projectFromTem:{},ProjectRules:{title:[{required:!0,message:"请输入项目标题",trigger:"blur"}],reportToName:[{required:!0,message:"请选择负责人",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}}}},computed:Object(i["a"])(Object(i["a"])({},Object(l["b"])({lang:function(e){return e.header.lang}})),{},{userUseOpenProject:function(){return this.$store.state.user.userinfo.userUseOpenProject}}),created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.edit();case 2:return t.next=4,e.setAllSysCustomField();case 4:return t.next=6,e.queryAllCustomField();case 6:case"end":return t.stop()}}),t)})))()},methods:{queryAllCustomField:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e,o={projectId:r.userUseOpenProject.projectId,scope:"project"},t.next=4,Object(c["g"])(o);case 4:a=t.sent,"200"===a.code&&console.log("res---",a);case 6:case"end":return t.stop()}}),t)})))()},edit:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e,!r.$route.query.id){t.next=8;break}return console.log("edit---",r.$route.query.id),t.next=5,Object(c["j"])(r.$route.query.id);case 5:o=t.sent,r.projectFrom=o.data,r.projectFromTem=Object.assign({},r.projectFrom);case 8:case"end":return t.stop()}}),t)})))()},setAllSysCustomField:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e,t.next=3,Object(c["h"])();case 3:o=t.sent,o.data.forEach((function(e,t){switch(e.sysCustomField.fieldName){case"project_status":r.statusListArr=e.mergeValues;break;case"customer_list":r.customerListArr=e.mergeValues;break;case"report_name":r.reportToNameArr=e.mergeValues;break;case"test_frame":r.testFrameArr=e.mergeValues;break;case"project_category":r.projectCategory=e.mergeValues;break}}));case 5:case"end":return t.stop()}}),t)})))()},remoteReport:function(e){var t=this;""!==e?(this.loading=!0,setTimeout((function(){t.loading=!1,Object(c["n"])({subUserName:e}).then((function(e){t.reportToNameArr=e.data}))}),200)):this.reportToNameArr=[]},resetFields:function(){this.projectFrom={id:void 0,title:void 0,description:void 0,reportToName:void 0,customer:void 0,status:void 0,testFrame:void 0,projectCategory:void 0,fileList:[]},this.$refs["projectFrom"].resetFields()},submitForm:function(e,t){var r=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;if(r.projectFrom.id){var o=Object(s["d"])(r.projectFromTem,r.projectFrom);Object(c["f"])(o).then((function(e){"200"===e.code&&(Object(s["e"])("success",e.msg),Object(s["f"])(r,1e3))})).catch((function(e){console.log(e)}))}else Object(c["a"])(r.projectFrom).then((function(e){"200"===e.code&&(Object(s["e"])("success",e.msg),r.resetFields(),t&&Object(s["f"])(r,1e3))})).catch((function(e){console.log(e)}))}))},giveupBack:function(){this.projectFrom.id||this.resetFields(),this.returntomenu(this)}}},d=p,m=(r("348f"),r("2877")),f=Object(m["a"])(d,o,a,!1,null,"057dee1d",null);t["default"]=f.exports},c7f0:function(e,t,r){"use strict";var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-upload",{staticClass:"upload-demo",attrs:{action:"","http-request":e.HandleUploadSelf,multiple:"","file-list":e.allfileList}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("附件")])],1),r("el-table",{ref:"allfileList",staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.allfileList,"header-cell-style":e.tableHeader,stripe:""}},[r("el-table-column",{attrs:{prop:"fileName","show-overflow-tooltip":!0,align:"center",label:"文件名称"}}),r("el-table-column",{attrs:{prop:"uploader",align:"center",label:"上传者"}}),r("el-table-column",{attrs:{prop:"modifyTime",align:"center",label:"更新时间","min-width":"120","show-overflow-tooltip":!0}}),r("el-table-column",{attrs:{label:"操作","min-width":"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{staticClass:"table-btn",attrs:{type:"text"},on:{click:function(r){return r.stopPropagation(),e.openfildEdit(t.row.id)}}},[e._v("编辑")]),r("el-button",{staticClass:"table-btn",attrs:{type:"text"},on:{click:function(r){return r.stopPropagation(),e.openfildDel(t.row.id)}}},[e._v("删除")])]}}])})],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.fileTotal>0,expression:"fileTotal > 0"}],attrs:{total:e.fileTotal,page:e.fileParams.pageNum,limit:e.fileParams.pageSize},on:{"update:page":function(t){return e.$set(e.fileParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.fileParams,"pageSize",t)},pagination:e.getfileList}}),r("el-dialog",{attrs:{title:"修改附件",visible:e.profileOpen,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.profileOpen=t}}},[r("div",[r("el-upload",{staticClass:"editupload-demo",attrs:{action:"","http-request":e.editUploadSelf,"before-remove":e.editbeforeRemove,multiple:"",limit:1,"on-exceed":e.editExceed,"file-list":e.editfileList}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("重新上传")])],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.fileSubForm}},[e._v("确 定")]),r("el-button",{on:{click:e.calloff}},[e._v("取消")])],1)])],1)},a=[],n=(r("4de4"),r("d3b7"),r("b0c0"),r("99af"),r("cf45")),i=r("b775");function l(e,t){return Object(i["a"])({url:"/attachment/addAttachment",method:"post",params:e,data:t})}function c(e){return Object(i["a"])({url:"/attachment/list",method:"get",params:e})}function s(e){return Object(i["a"])({url:"/attachment/deleteAttachment/"+e,method:"delete"})}function u(e,t){return Object(i["a"])({url:"/attachment/updateAttachment/"+e,method:"post",data:t})}var p={name:"Upload",props:{linkId:{required:!0,type:String},type:{required:!0,type:String}},data:function(){return{profileOpen:!1,tableHeader:{color:"#d4dce3",background:"#4286CD"},editfileList:[],onefileList:[],onefileId:"",allfileList:[],fileTotal:0,fileParams:{pageNum:1,pageSize:10,type:"",linkId:""}}},created:function(){this.fileParams.type=this.type,this.fileParams.linkId=this.linkId,console.log(this.type,this.linkId),this.getfileList()},methods:{HandleUploadSelf:function(e){var t=this,r={type:this.type,linkId:this.linkId};l(r,Object(n["c"])({file:e.file})).then((function(e){"200"===e.code&&(Object(n["e"])("success",e.msg),t.getfileList())}))},getfileList:function(){var e=this;c(this.fileParams).then((function(t){"200"===t.code&&(t.data.filter((function(e){e["name"]=e.fileName})),e.allfileList=t.data,e.fileTotal=t.total)}))},openfildEdit:function(e){this.profileOpen=!0,this.onefileId=e},editExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},editbeforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},editUploadSelf:function(e,t){this.onefileList=e},fileSubForm:function(){var e=this;this.profileOpen=!1,u(this.onefileId,Object(n["c"])({file:this.onefileList.file})).then((function(t){"200"===t.code&&(Object(n["e"])("success",t.msg),e.onefileList=[],e.editfileList=[],e.getfileList())}))},calloff:function(){this.profileOpen=!1},openfildDel:function(e){var t=this;s(e).then((function(e){"200"===e.code&&(Object(n["e"])("success",e.msg),t.getfileList())}))}}},d=p,m=(r("f987"),r("2877")),f=Object(m["a"])(d,o,a,!1,null,"76a50506",null);t["a"]=f.exports},f987:function(e,t,r){"use strict";r("00b3")}}]);